---
# DigitalOcean:  droplet destruction tasks


- name: "Refuse to destroy droplet if 'confirm' is not set to 'yes'"
  fail: msg="Please set '-e confirm=yes' to destroy droplet"
  when: confirm|default('no') != 'yes'

- name:  Destroy droplet
  digital_ocean:
    state: absent
    command: droplet
    name: "{{ fqdn }}"
    unique_name: yes
    api_token:  "{{ do_token }}"

- name:  "Destroy ansible cached data in var/cache/{{hostname}}"
  file:
    path: "../var/cache/{{hostname}}"
    state: absent
  delegate_to: localhost
